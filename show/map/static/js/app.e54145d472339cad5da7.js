webpackJsonp([1],{"6+aJ":function(t,e,i){"use strict";function o(t){i("Gcms")}var n=i("iTc6"),a=i("K3ys"),s=i("VU/8"),r=o,l=s(n.a,a.a,!1,r,"data-v-e262bed4",null);e.a=l.exports},"98sv":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("mainIndex")],1)},n=[],a={render:o,staticRenderFns:n};e.a=a},C4Az:function(t,e){},Gcms:function(t,e){},K3ys:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%",height:"100%"},on:{click:t.listHide}},[i("div",{attrs:{id:"map"}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.listShow,expression:"listShow"}],style:"left:"+t.listStyle.left+"px;top:"+t.listStyle.top+"px;",attrs:{id:"list"}},t._l(t.list,function(e){return i("div",[i("a",{on:{click:function(i){t.listCli(e.href)}}},[t._v(t._s(e.title))])])})),t._v(" "),i("div",{attrs:{id:"button"}},t._l(t.button,function(e,o){return i("div",[i("a",{class:e.selected?"selected":"",on:{click:function(i){t.buttonCli(e.key,o)}}},[t._v(t._s(e.value))])])})),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.surveyShow,expression:"surveyShow"}],attrs:{id:"show"}},[i("div",{staticClass:"showTitle"},[t._v("工程概况")]),t._v(" "),i("table",{staticStyle:{width:"300px"}},[i("tr",[i("td",{staticStyle:{"text-align":"right"}},[t._v("长度：")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v(t._s(t.survey.length))])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"right"}},[t._v("额定电压：")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v(t._s(t.survey.voltage))])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"right"}},[t._v("额定功率：")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v(t._s(t.survey.power))])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"right"}},[t._v("投产时间：")]),t._v(" "),i("td",{staticStyle:{"text-align":"left"}},[t._v(t._s(t.survey.time))])])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.devInfoShow,expression:"devInfoShow"}],attrs:{id:"show"}},[i("div",{staticClass:"showTitle"},[t._v("设备信息")]),t._v(" "),i("br"),t._v(" "),i("br"),t._v(" "),i("br"),t._v(" "),i("br"),t._v(" "),i("br")])])},n=[],a={render:o,staticRenderFns:n};e.a=a},M93x:function(t,e,i){"use strict";function o(t){i("C4Az")}var n=i("xJD8"),a=i("98sv"),s=i("VU/8"),r=o,l=s(n.a,a.a,!1,r,null,null);e.a=l.exports},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("//Fk"),n=i.n(o),a=i("7+uW"),s=i("M93x"),r=i("mtWM"),l=i.n(r),d=i("XLwt"),c=i.n(d);a.a.config.productionTip=!1,window.echarts=c.a,a.a.prototype.$Axios=l.a,l.a.defaults.baseURL="http://doclever.cn:8090/mock/58ce54aee2184962da09fc51",l.a.interceptors.response.use(function(t){var e=t.data;return"string"==typeof e&&e.constructor==String&&(e=JSON.parse(e)),e},function(t){return n.a.reject(t)}),new a.a({el:"#app",template:"<App/>",components:{App:s.a}})},iTc6:function(t,e,i){"use strict";var o=i("mvHQ"),n=i.n(o);e.a={data:function(){return{mapJson:{},chart:{},button:[{key:"move",selected:!1,value:"拖动"}],survey:{length:"2090",voltage:"800kV",power:"720万KW",time:"2012年12月12日"},roam:!0,surveyShow:!1,devInfoShow:!1,buttonTemp:[],moveSubmit:!1,moveReady:!1,pointMove:{state:!1,dataIndex:[-1,0]},pointMoved:[],title:"",listShow:!1,listStyle:{left:0,top:0},key:"",list:[],listData:{point:[],line:[]},dataTemp:[],data:[]}},methods:{buttonCli:function(t,e){var i=this;if(this.pointMoveStateToFalse(),this.selectedClear(e),this.button[e].selected=!this.button[e].selected,"move"===t)this.roam=this.moveSubmit,this.moveSubmit=!this.moveSubmit,this.mapDraw(),this.dataTemp=JSON.parse(n()(this.data)),this.buttonTemp=JSON.parse(n()(this.button));else if("moveSubmit"===t){this.moveReady=!1;var o=new URLSearchParams;o.append("point",this.pointMoved),this.$Axios.post("/setPointCoord",o).then(function(t){console.log(i.pointMoved),i.pointMoved=[]}).catch(function(t){return console.log(t)}),this.button=this.buttonTemp,this.selectedClear(-1),this.roam=!0,this.mapDraw()}else"moveCancel"===t&&(this.pointMoved=[],this.moveReady=!1,this.data=this.dataTemp,this.button=this.buttonTemp,this.selectedClear(-1),this.roam=!0,this.mapDraw())},selectedClear:function(t){var e=this.button.map(function(e,i){return t!=i&&(e.selected=!1),e});this.button=e},selectCoordById:function(t,e){for(var i=0;i<e.length;i++)if(e[i].id==t)return e[i].coord;return console.error(e,"找不到id为"+t+"的点"),[]},listHide:function(){this.listShow=!1,this.surveyShow=!1,this.devInfoShow=!1},formatLegend:function(t){var e=[];return t.forEach(function(t){e.push({name:t.legend})}),e},listCli:function(t){this.listHide(),"survey"===t?this.$nextTick(function(){this.surveyShow=!0}):"devInfo"===t?this.$nextTick(function(){this.devInfoShow=!0}):window.open(t+"?id="+this.key)},formatSeries:function(t){var e=this,i=[];return t.forEach(function(t){var o=[],n=[];t.point&&t.point.length>0&&t.point.forEach(function(t){n.push({name:t.name,symbolSize:10,label:{normal:{show:!1},emphasis:{show:!1}},itemStyle:{normal:{color:""}},coord:t.coord})}),t.line&&t.line.length>0&&t.line.forEach(function(i){o.push([{name:i.name,coord:e.selectCoordById(i.point[0],t.point)},{coord:e.selectCoordById(i.point[1],t.point)}])}),i.push({name:t.legend,type:"scatter",coordinateSystem:"geo",markLine:{symbol:["none","none"],label:{normal:{show:!1}},lineStyle:{normal:{type:"solid"}},data:o},markPoint:{symbol:"circle",data:n}})}),i},addColor:function(){var t=[];return this.mapJson.features.forEach(function(e){t.push({name:e.properties.name,itemStyle:{normal:{color:"#049392"},emphasis:{color:"#049392"}}})}),t},pointMoveStateToFalse:function(){if(this.pointMove.state=-1!==this.pointMove.dataIndex[0]){this.pointMove.state=!1;for(var t={id:this.key,coord:this.data[this.pointMove.dataIndex[0]].point[this.pointMove.dataIndex[1]].coord},e=-1,i=0;i<this.pointMoved.length;i++)if(this.pointMoved[i].id===t.id){e=i;break}-1===e?this.pointMoved.push(t):this.pointMoved[e]=t,this.mapDraw(),this.pointMove.dataIndex[0]=-1}},mapInit:function(){var t=this;echarts.registerMap("jiangsu",this.mapJson),this.chart=echarts.init(document.getElementById("map")),this.chart.on("mousedown",function(e){event.stopImmediatePropagation(),t.listHide(),"markPoint"===e.componentType&&(t.moveSubmit&&(t.moveSubmit=!1,t.moveReady=!0,t.button=[{key:"moveSubmit",value:"保存拖动"},{key:"moveCancel",value:"还原拖动"}]),t.moveReady&&(t.key=t.data[e.seriesIndex].point[e.dataIndex].id,t.pointMove.dataIndex=[e.seriesIndex,e.dataIndex],t.pointMove.state=!0))}),this.chart.on("mouseup",function(e){t.pointMoveStateToFalse()}),this.chart.on("contextmenu",function(e){t.pointMoveStateToFalse(),event.preventDefault(),t.listHide(),"markPoint"===e.componentType?(t.list=t.listData.point,t.key=t.data[e.seriesIndex].point[e.dataIndex].id,t.listStyle.left=event.zrX+1,t.listStyle.top=event.zrY+1,t.listShow=!0):"markLine"===e.componentType&&(t.list=t.listData.line,t.key=t.data[e.seriesIndex].line[e.dataIndex].id,t.listStyle.left=event.zrX+1,t.listStyle.top=event.zrY+1,t.listShow=!0)}),this.mapDraw()},mapDraw:function(){this.chart.setOption({title:{text:this.title,top:10,left:10,textStyle:{fontSize:30,color:"#fff"}},legend:{show:!0,left:20,top:"30%",orient:"vertical",textStyle:{color:"#fff"},data:this.formatLegend(this.data)},tooltip:{trigger:"item",formatter:function(t){return t.data.name}},animation:!0,geo:{roam:this.roam,map:"jiangsu",zoom:1.2,regions:this.addColor(),label:{normal:{show:!0,textStyle:{color:"#fff"}}},itemStyle:{normal:{borderColor:"#172124",borderWidth:2}}},series:this.formatSeries(this.data)})},init:function(){window.onresize=function(){echarts.dispose(document.getElementById("map")),this.$nextTick(function(){this.mapInit()})}.bind(this),window.oncontextmenu=function(){this.pointMoveStateToFalse(),event.preventDefault()}.bind(this),window.onmousemove=function(t){var e=this;window.clearTimeout(window.timeoutID),window.timeoutID=setTimeout(function(){e.pointMove.state&&(e.data[e.pointMove.dataIndex[0]].point[e.pointMove.dataIndex[1]].coord=e.chart.convertFromPixel("geo",[t.zrX,t.zrY]),e.mapDraw())},200)}.bind(this)}},mounted:function(){var t=this;this.$Axios.all([this.$Axios.get("/getData").then(function(e){t.data=e.data,t.listData=e.listData,e.title&&(t.title=e.title)}),this.$Axios.get("/getMap").then(function(e){t.mapJson=e})]).then(function(e){t.$nextTick(function(){this.mapInit()}),t.init()}).catch(function(t){console.error(t)})}}},xJD8:function(t,e,i){"use strict";var o=i("6+aJ");e.a={name:"app",components:{mainIndex:o.a}}}},["NHnr"]);
//# sourceMappingURL=app.e54145d472339cad5da7.js.map